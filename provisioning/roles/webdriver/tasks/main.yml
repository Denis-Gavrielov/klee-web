---
- name: Install flake8
  pip: name=flake8

- name: Install HTTPIE
  pip: name=httpie

# INSTALL NPM NOW THAT IT IS INSTALLED WITHIN THE DOCKER CONTAINER
- name: "Add official NodeJS repo 6.x"
  shell: curl -sL https://deb.nodesource.com/setup_6.x | sudo -E bash -
  tags: nodejs

- name: "Install node.js"
  apt: name=nodejs update_cache=yes
  tags: nodejs

- name: "Update npm"
  npm: name=npm global=yes state=latest

- name: "Install phantomjs for CI"
  npm: name=phantomjs version=2.1.1 unsafe_perm=yes path={{ application_dir }}
  become: yes
  when: ci|bool

- name: "Install E2E test dependencies"
  npm: path={{ application_dir }} 
  become: yes
  when: ci|bool

- name: "Install E2E test dependencies in tests folder"
  npm: path={{ application_dir }}/tests 
  become: yes
  when: ci|bool

- name: "Install E2E test dependencies"
  npm: path={{ application_dir }}/tests
  become: no
  when: not ci
